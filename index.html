<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hebrew Learning Journey</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .nav-tabs { display: flex; flex-wrap: wrap; justify-content: center; margin-bottom: 30px; gap: 10px; }
        .tab-btn { padding: 12px 24px; background: rgba(255,255,255,0.9); border: none; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; }
        .tab-btn.active { background: #4CAF50; color: white; }
        .tab-content { background: rgba(255,255,255,0.95); border-radius: 20px; padding: 30px; min-height: 600px; }
        .hidden { display: none; }
        .hebrew-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .letter-card { background: linear-gradient(145deg, #f0f0f0, #ffffff); border-radius: 15px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 3px solid transparent; }
        .letter-card:hover { transform: translateY(-5px); }
        .letter-card.selected { border-color: #4CAF50; background: linear-gradient(145deg, #e8f5e8, #f0fff0); }
        .hebrew-char { font-size: 4em; font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-family: 'Times New Roman', serif; }
        .controls { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-bottom: 30px; }
        .btn { padding: 12px 24px; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; }
        .btn-primary { background: linear-gradient(145deg, #3498db, #2980b9); color: white; }
        .btn-success { background: linear-gradient(145deg, #2ecc71, #27ae60); color: white; }
        .btn-warning { background: linear-gradient(145deg, #f39c12, #e67e22); color: white; }
        .flashcard { background: linear-gradient(145deg, #ffffff, #f8f9fa); border-radius: 20px; padding: 40px; text-align: center; max-width: 500px; margin: 0 auto; min-height: 300px; display: flex; flex-direction: column; justify-content: center; }
        .flashcard .hebrew-char { font-size: 6em; margin-bottom: 20px; }
        .quiz-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-top: 20px; }
        .quiz-option { padding: 15px; background: linear-gradient(145deg, #f0f0f0, #ffffff); border: 2px solid transparent; border-radius: 10px; cursor: pointer; text-align: center; transition: all 0.3s ease; }
        .quiz-option:hover { transform: translateY(-2px); }
        .quiz-option.correct { border-color: #2ecc71; background: linear-gradient(145deg, #d5f4e6, #e8f8f5); }
        .quiz-option.incorrect { border-color: #e74c3c; background: linear-gradient(145deg, #fadbd8, #fdeaea); }
        .quiz-option.selected { border-color: #3498db; background: linear-gradient(145deg, #dae8fc, #e8f4fd); }
        .drag-item { padding: 15px 20px; background: linear-gradient(145deg, #3498db, #2980b9); color: white; border-radius: 10px; cursor: grab; user-select: none; transition: all 0.3s ease; margin: 5px; }
        .drag-item:active { cursor: grabbing; transform: rotate(5deg); }
        .drag-item.dragging { opacity: 0.5; transform: rotate(5deg); }
        .drop-zone { background: rgba(46, 204, 113, 0.1); border: 2px dashed #2ecc71; border-radius: 15px; padding: 30px; text-align: center; min-height: 150px; display: flex; flex-direction: column; justify-content: center; transition: all 0.3s ease; }
        .drop-zone.drag-over { background: rgba(46, 204, 113, 0.2); border-color: #27ae60; transform: scale(1.02); }
        .drop-zone.filled { background: rgba(52, 152, 219, 0.1); border-color: #3498db; }
        .drop-zone .hebrew-char { font-size: 3em; margin-bottom: 10px; }
        .progress-bar { background: rgba(236, 240, 241, 0.8); border-radius: 25px; padding: 4px; margin-bottom: 20px; }
        .progress-fill { background: linear-gradient(90deg, #2ecc71, #27ae60); border-radius: 20px; height: 20px; transition: width 0.5s ease; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üïäÔ∏è Hebrew Learning Journey</h1>
            <p>Your path to understanding the sacred language</p>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" data-tab="alphabet">üìö Alphabet</button>
            <button class="tab-btn" data-tab="flashcards">üé¥ Flashcards</button>
            <button class="tab-btn" data-tab="quiz">üß† Quiz</button>
            <button class="tab-btn" data-tab="dragdrop">üéØ Match Game</button>
            <button class="tab-btn" data-tab="siddur">üìñ Siddur Words</button>
            <button class="tab-btn" data-tab="roots">üå≥ Word Roots</button>
        </div>

        <div id="alphabet" class="tab-content">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Hebrew Alphabet - Click letters to select</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="alphabetProgress" style="width: 0%">0% Selected</div>
            </div>
            <div class="controls">
                <button class="btn btn-success" id="selectAll">Select All</button>
                <button class="btn btn-warning" id="clearAll">Clear</button>
                <button class="btn btn-primary" id="startLearning">Start Learning</button>
                <button class="btn btn-primary" id="showVowels">Show Vowels</button>
                <button class="btn btn-primary" id="showFinalLetters">Final Letters</button>
            </div>
            <div class="hebrew-grid" id="hebrewGrid"></div>
            
            <div id="vowelsSection" class="hidden" style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 20px; color: #2c3e50;">Hebrew Vowels (Nikud)</h3>
                <div class="hebrew-grid" id="vowelsGrid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));"></div>
            </div>

            <div id="finalLettersSection" class="hidden" style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 20px; color: #2c3e50;">Final Letters (Sofit)</h3>
                <p style="text-align: center; margin-bottom: 20px; color: #7f8c8d; font-size: 0.9em;">
                    These letters appear only at the end of words
                </p>
                <div class="hebrew-grid" id="finalLettersGrid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));"></div>
            </div>
        </div>

        <div id="flashcards" class="tab-content hidden">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Flashcard Learning</h2>
            <div class="controls">
                <button class="btn btn-primary" id="prevCard">‚Üê Previous</button>
                <button class="btn btn-success" id="flipCard">Flip Card</button>
                <button class="btn btn-primary" id="nextCard">Next ‚Üí</button>
            </div>
            <div class="flashcard">
                <div class="hebrew-char" id="cardChar">◊ê</div>
                <div id="cardInfo" style="font-size: 1.5em;">Click "Flip Card" to see details</div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <span id="cardCounter">Card 1 of 22</span>
            </div>
        </div>

        <div id="quiz" class="tab-content hidden">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Hebrew Letter Quiz</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="quizProgress" style="width: 0%">0/10</div>
            </div>
            <div style="max-width: 600px; margin: 0 auto;">
                <div style="background: linear-gradient(145deg, #ffffff, #f8f9fa); border-radius: 15px; padding: 30px; text-align: center; margin-bottom: 20px;">
                    <div class="hebrew-char" id="quizChar">◊ê</div>
                    <p>What is this Hebrew letter?</p>
                    <div class="quiz-options" id="quizOptions"></div>
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-primary" id="nextQuestion">Next Question</button>
                </div>
            </div>
        </div>

        <div id="dragdrop" class="tab-content hidden">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Match Letters to Names</h2>
            <p style="text-align: center; margin-bottom: 30px;">Drag the letter names to match with the Hebrew characters</p>
            <div style="display: flex; flex-direction: column; gap: 30px; align-items: center;">
                <div id="dragLetters" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; padding: 20px; background: rgba(52, 152, 219, 0.1); border-radius: 15px; min-height: 100px;"></div>
                <div id="dropZones" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; width: 100%;"></div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-success" id="checkDragMatches">Check Answers</button>
                <button class="btn btn-warning" id="resetDragDrop">New Round</button>
            </div>
        </div>

        <div id="siddur" class="tab-content hidden">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Siddur Words</h2>
            <div class="controls">
                <button class="btn btn-primary" id="wordFlashcards">üìö Word Flashcards</button>
                <button class="btn btn-success" id="wordMatching">üéØ Match Game</button>
            </div>
            <div class="hebrew-grid" id="siddurWordGrid"></div>
            
            <div id="wordGames" class="hidden">
                <div id="wordFlashcardGame" class="hidden">
                    <button class="btn btn-warning" onclick="backToSiddur()">‚Üê Back</button>
                    <div class="flashcard">
                        <div class="hebrew-char" id="wordCardHebrew">◊©◊ú◊ï◊ù</div>
                        <div id="wordCardInfo" style="font-size: 1.5em;">Click to reveal meaning</div>
                        <div class="controls" style="margin-top: 20px;">
                            <button class="btn btn-primary" id="prevWordCard">‚Üê Previous</button>
                            <button class="btn btn-success" id="flipWordCard">Flip</button>
                            <button class="btn btn-primary" id="nextWordCard">Next ‚Üí</button>
                        </div>
                    </div>
                </div>

                <div id="wordMatchingGame" class="hidden">
                    <button class="btn btn-warning" onclick="backToSiddur()">‚Üê Back</button>
                    <h3 style="text-align: center; margin: 20px 0;">Match Hebrew words with English meanings</h3>
                    <div id="matchingArea" style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; max-width: 800px; margin: 0 auto;">
                        <div id="hebrewWords"></div>
                        <div id="englishMeanings"></div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success" id="checkMatches">Check Answers</button>
                        <button class="btn btn-warning" id="newRound">New Round</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="roots" class="tab-content hidden">
            <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">Hebrew Word Patterns (Shoresh)</h2>
            <p style="text-align: center; margin-bottom: 30px; color: #7f8c8d;">Learn how Hebrew words are built from 3-letter roots</p>
            
            <div class="controls">
                <button class="btn btn-primary" id="rootFlashcards">üìö Root Flashcards</button>
                <button class="btn btn-success" id="patternQuiz">üß© Pattern Quiz</button>
                <button class="btn btn-warning" id="showAllRoots">üìã View All Roots</button>
            </div>

            <div id="rootsGrid" class="hebrew-grid"></div>
            
            <div id="rootGames" class="hidden">
                <div id="rootFlashcardGame" class="hidden">
                    <button class="btn btn-warning" onclick="backToRoots()">‚Üê Back</button>
                    <div class="flashcard">
                        <div class="hebrew-char" id="rootCardRoot" style="font-size: 4em;">◊õ◊™◊ë</div>
                        <div id="rootCardInfo" style="font-size: 1.2em; margin: 20px 0;">Click to reveal meaning and examples</div>
                        <div id="rootExamples" class="hidden" style="background: rgba(52, 152, 219, 0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                            <h4 style="margin-bottom: 15px; color: #2c3e50;">Example Words:</h4>
                            <div id="examplesList"></div>
                        </div>
                        <div class="controls" style="margin-top: 20px;">
                            <button class="btn btn-primary" id="prevRootCard">‚Üê Previous</button>
                            <button class="btn btn-success" id="flipRootCard">Flip</button>
                            <button class="btn btn-primary" id="nextRootCard">Next ‚Üí</button>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <span id="rootCardCounter">Root 1 of 20</span>
                    </div>
                </div>

                <div id="patternQuizGame" class="hidden">
                    <button class="btn btn-warning" onclick="backToRoots()">‚Üê Back</button>
                    <h3 style="text-align: center; margin: 20px 0;">Identify the Root Pattern</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="patternProgress" style="width: 0%">0/10</div>
                    </div>
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="background: linear-gradient(145deg, #ffffff, #f8f9fa); border-radius: 15px; padding: 30px; text-align: center; margin-bottom: 20px;">
                            <div class="hebrew-char" id="patternQuizWord" style="font-size: 3em;">◊õ÷∏÷º◊™÷∑◊ë</div>
                            <p style="margin: 15px 0;">What is the 3-letter root of this word?</p>
                            <div class="quiz-options" id="patternOptions"></div>
                        </div>
                        <div style="text-align: center;">
                            <button class="btn btn-primary" id="nextPatternQuestion">Next Question</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const letters = [
            { char: '◊ê', name: 'Aleph', sound: 'silent/ah', number: 1 },
            { char: '◊ë', name: 'Bet', sound: 'b', number: 2, variant: 'with dot' },
            { char: '◊ë÷ø', name: 'Vet', sound: 'v', number: 2, variant: 'without dot' },
            { char: '◊í', name: 'Gimel', sound: 'g', number: 3 },
            { char: '◊ì', name: 'Dalet', sound: 'd', number: 4 },
            { char: '◊î', name: 'Hey', sound: 'h', number: 5 },
            { char: '◊ï', name: 'Vav', sound: 'v/o/u', number: 6 },
            { char: '◊ñ', name: 'Zayin', sound: 'z', number: 7 },
            { char: '◊ó', name: 'Chet', sound: 'ch', number: 8 },
            { char: '◊ò', name: 'Tet', sound: 't', number: 9 },
            { char: '◊ô', name: 'Yod', sound: 'y/i', number: 10 },
            { char: '◊õ', name: 'Kaf', sound: 'k', number: 20, variant: 'with dot' },
            { char: '◊õ÷ø', name: 'Chaf', sound: 'ch', number: 20, variant: 'without dot' },
            { char: '◊ö', name: 'Final Kaf', sound: 'k/ch', number: 20, variant: 'final form' },
            { char: '◊ú', name: 'Lamed', sound: 'l', number: 30 },
            { char: '◊û', name: 'Mem', sound: 'm', number: 40 },
            { char: '◊ù', name: 'Final Mem', sound: 'm', number: 40, variant: 'final form' },
            { char: '◊†', name: 'Nun', sound: 'n', number: 50 },
            { char: '◊ü', name: 'Final Nun', sound: 'n', number: 50, variant: 'final form' },
            { char: '◊°', name: 'Samech', sound: 's', number: 60 },
            { char: '◊¢', name: 'Ayin', sound: 'silent/ah', number: 70 },
            { char: '◊§', name: 'Pey', sound: 'p', number: 80, variant: 'with dot' },
            { char: '◊§÷ø', name: 'Fey', sound: 'f', number: 80, variant: 'without dot' },
            { char: '◊£', name: 'Final Pey', sound: 'p/f', number: 80, variant: 'final form' },
            { char: '◊¶', name: 'Tzadi', sound: 'tz', number: 90 },
            { char: '◊•', name: 'Final Tzadi', sound: 'tz', number: 90, variant: 'final form' },
            { char: '◊ß', name: 'Qof', sound: 'k', number: 100 },
            { char: '◊®', name: 'Resh', sound: 'r', number: 200 },
            { char: '◊©◊Ç', name: 'Sin', sound: 's', number: 300, variant: 'left dot' },
            { char: '◊©◊Å', name: 'Shin', sound: 'sh', number: 300, variant: 'right dot' },
            { char: '◊™', name: 'Tav', sound: 't', number: 400 }
        ];

        const vowels = [
            { char: '÷∑', name: 'Patach', sound: 'ah', type: 'short vowel', example: '◊ë÷∑÷º◊™' },
            { char: '÷∏', name: 'Kamatz', sound: 'ah/oh', type: 'long vowel', example: '◊ë÷∏÷º◊ê' },
            { char: '÷∂', name: 'Segol', sound: 'eh', type: 'short vowel', example: '◊ë÷∂÷º◊ü' },
            { char: '÷µ', name: 'Tzere', sound: 'eh/ay', type: 'long vowel', example: '◊ë÷µ÷º◊ô◊ü' },
            { char: '÷¥', name: 'Chirik', sound: 'ee', type: 'short vowel', example: '◊ë÷¥÷º◊ô◊ü' },
            { char: '÷¥◊ô', name: 'Chirik Malei', sound: 'ee', type: 'long vowel', example: '◊ë÷¥÷º◊ô◊ú' },
            { char: '÷π', name: 'Cholam', sound: 'oh', type: 'long vowel', example: '◊ë÷π÷º◊ê' },
            { char: '◊ï÷π', name: 'Cholam Malei', sound: 'oh', type: 'long vowel', example: '◊ë÷º◊ï÷π◊ê' },
            { char: '÷ª', name: 'Kubutz', sound: 'oo', type: 'short vowel', example: '◊ë÷ª÷º◊ú' },
            { char: '◊ï÷º', name: 'Shuruk', sound: 'oo', type: 'long vowel', example: '◊ë÷º◊ï÷º◊ú' },
            { char: '÷∞', name: 'Shva', sound: 'eh/silent', type: 'reduced vowel', example: '◊ë÷∞÷º' },
            { char: '÷≤', name: 'Chataf Patach', sound: 'ah', type: 'reduced vowel', example: '◊ê÷≤' },
            { char: '÷±', name: 'Chataf Segol', sound: 'eh', type: 'reduced vowel', example: '◊ê÷±' },
            { char: '÷≥', name: 'Chataf Kamatz', sound: 'oh', type: 'reduced vowel', example: '◊ê÷≥' },
            { char: '÷º', name: 'Dagesh', sound: 'emphasis/doubling', type: 'modifier', example: '◊ë÷º' }
        ];

        const finalLetters = [
            { 
                regular: '◊õ', 
                final: '◊ö', 
                name: 'Kaf/Chaf', 
                sound: 'k/ch', 
                number: 20,
                examples: { regular: '◊õ÷π÷º◊ú (all)', final: '◊û÷∂◊ú÷∂◊ö÷∞ (king)' }
            },
            { 
                regular: '◊û', 
                final: '◊ù', 
                name: 'Mem', 
                sound: 'm', 
                number: 40,
                examples: { regular: '◊û÷∏◊î (what)', final: '◊©÷∏◊Å◊ú◊ï÷π◊ù (peace)' }
            },
            { 
                regular: '◊†', 
                final: '◊ü', 
                name: 'Nun', 
                sound: 'n', 
                number: 50,
                examples: { regular: '◊†÷∏◊™÷∑◊ü (gave)', final: '◊ë÷µ÷º◊ü (son)' }
            },
            { 
                regular: '◊§', 
                final: '◊£', 
                name: 'Pey/Fey', 
                sound: 'p/f', 
                number: 80,
                examples: { regular: '◊§÷π÷º◊î (here)', final: '◊ê÷∑◊£ (also/nose)' }
            },
            { 
                regular: '◊¶', 
                final: '◊•', 
                name: 'Tzadi', 
                sound: 'tz', 
                number: 90,
                examples: { regular: '◊¶÷∂◊ì÷∂◊ß (justice)', final: '◊ê÷∂◊®÷∂◊• (land)' }
            }
        ];

        const words = [
            { hebrew: '◊©÷∏◊Å◊ú◊ï÷π◊ù', meaning: 'Peace / Hello / Goodbye' },
            { hebrew: '◊ë÷∏÷º◊®◊ï÷º◊ö÷∞', meaning: 'Blessed' },
            { hebrew: '◊ê÷±◊ú÷π◊î÷¥◊ô◊ù', meaning: 'God' },
            { hebrew: '◊™÷º◊ï÷π◊®÷∏◊î', meaning: 'Torah / Teaching' },
            { hebrew: '◊©÷∑◊Å◊ë÷∏÷º◊™', meaning: 'Sabbath' },
            { hebrew: '◊ê÷∏◊û÷µ◊ü', meaning: 'Amen' },
            { hebrew: '◊û÷¥◊¶÷∞◊ï÷∏◊î', meaning: 'Commandment' },
            { hebrew: '◊ß÷∏◊ì◊ï÷π◊©◊Å', meaning: 'Holy' },
            { hebrew: '◊©÷∞◊Å◊û÷∑◊¢', meaning: 'Hear' },
            { hebrew: '◊î÷∑◊ú÷∞◊ú◊ï÷º◊ô÷∏◊î÷º', meaning: 'Praise God' },
            { hebrew: '◊ú÷µ◊ë', meaning: 'Heart' },
            { hebrew: '◊†÷∂◊§÷∂◊©◊Å', meaning: 'Soul' },
            { hebrew: '◊ê◊ï÷π◊®', meaning: 'Light' },
            { hebrew: '◊ó÷∑◊ô÷¥÷º◊ô◊ù', meaning: 'Life' },
            { hebrew: '◊û÷∂◊ú÷∂◊ö÷∞', meaning: 'King' },
            { hebrew: '◊¢◊ï÷π◊ú÷∏◊ù', meaning: 'World' },
            { hebrew: '◊ò◊ï÷π◊ë', meaning: 'Good' },
            { hebrew: '◊ê÷±◊û÷∂◊™', meaning: 'Truth' },
            { hebrew: '◊ô◊ï÷π◊ù', meaning: 'Day' },
            { hebrew: '◊ê÷∑◊î÷≤◊ë÷∏◊î', meaning: 'Love' }
        ];

        const hebrewRoots = [
            { root: '◊õ◊™◊ë', meaning: 'write', examples: [
                { word: '◊õ÷∏÷º◊™÷∑◊ë', form: 'he wrote', pattern: 'qatal' },
                { word: '◊õ÷π÷º◊™÷µ◊ë', form: 'writing/writer', pattern: 'qotel' },
                { word: '◊û÷¥◊õ÷∞◊™÷∏÷º◊ë', form: 'letter', pattern: 'miqtal' },
                { word: '◊õ÷∞÷º◊™÷π◊ë÷∂◊™', form: 'address', pattern: 'qetolet' }
            ]},
            { root: '◊ê◊û◊®', meaning: 'say/speak', examples: [
                { word: '◊ê÷∏◊û÷∑◊®', form: 'he said', pattern: 'qatal' },
                { word: '◊ê÷π◊û÷µ◊®', form: 'saying/speaker', pattern: 'qotel' },
                { word: '◊û÷∑◊ê÷≤◊û÷∏◊®', form: 'article/saying', pattern: 'maqtal' },
                { word: '◊ê÷µ◊û÷∂◊®', form: 'word/speech', pattern: 'qetel' }
            ]},
            { root: '◊î◊ú◊ö', meaning: 'go/walk', examples: [
                { word: '◊î÷∏◊ú÷∑◊ö÷∞', form: 'he went', pattern: 'qatal' },
                { word: '◊î◊ï÷π◊ú÷µ◊ö÷∞', form: 'going/walker', pattern: 'qotel' },
                { word: '◊û÷∑◊î÷≤◊ú÷∏◊ö÷∞', form: 'journey', pattern: 'maqtal' },
                { word: '◊î÷≤◊ú÷¥◊ô◊õ÷∏◊î', form: 'walking', pattern: 'haqtala' }
            ]},
            { root: '◊¢◊©◊î', meaning: 'do/make', examples: [
                { word: '◊¢÷∏◊©÷∏◊Ç◊î', form: 'he did/made', pattern: 'qatal' },
                { word: '◊¢÷π◊©÷∂◊Ç◊î', form: 'doing/maker', pattern: 'qotel' },
                { word: '◊û÷∑◊¢÷≤◊©÷∂◊Ç◊î', form: 'deed/work', pattern: 'maqtel' },
                { word: '◊™÷∑÷º◊¢÷≤◊©÷¥◊Ç◊ô÷∏÷º◊î', form: 'industry', pattern: 'taqtilya' }
            ]},
            { root: '◊ë◊®◊ê', meaning: 'create', examples: [
                { word: '◊ë÷∏÷º◊®÷∏◊ê', form: 'he created', pattern: 'qatal' },
                { word: '◊ë÷º◊ï÷π◊®÷µ◊ê', form: 'creator', pattern: 'qotel' },
                { word: '◊ë÷∞÷º◊®÷¥◊ô◊ê÷∏◊î', form: 'creation', pattern: 'qetila' },
                { word: '◊û÷¥◊ë÷∞◊®÷∏◊ê', form: 'creature', pattern: 'miqtal' }
            ]},
            { root: '◊ß◊ì◊©', meaning: 'holy/sanctify', examples: [
                { word: '◊ß÷∏◊ì÷∑◊©◊Å', form: 'he was holy', pattern: 'qatal' },
                { word: '◊ß÷∏◊ì◊ï÷π◊©◊Å', form: 'holy', pattern: 'qatul' },
                { word: '◊û÷¥◊ß÷∞◊ì÷∏÷º◊©◊Å', form: 'sanctuary', pattern: 'miqtal' },
                { word: '◊ß÷∞◊ì÷ª◊©÷∏÷º◊Å◊î', form: 'holiness', pattern: 'qetulla' }
            ]},
            { root: '◊©◊û◊®', meaning: 'guard/keep', examples: [
                { word: '◊©÷∏◊Å◊û÷∑◊®', form: 'he guarded', pattern: 'qatal' },
                { word: '◊©◊Å◊ï÷π◊û÷µ◊®', form: 'guard/keeper', pattern: 'qotel' },
                { word: '◊û÷¥◊©÷∞◊Å◊û÷∏◊®', form: 'guard duty', pattern: 'miqtal' },
                { word: '◊©÷∞◊Å◊û÷¥◊ô◊®÷∏◊î', form: 'guarding', pattern: 'qetila' }
            ]},
            { root: '◊ê◊î◊ë', meaning: 'love', examples: [
                { word: '◊ê÷∏◊î÷∑◊ë', form: 'he loved', pattern: 'qatal' },
                { word: '◊ê◊ï÷π◊î÷µ◊ë', form: 'loving/lover', pattern: 'qotel' },
                { word: '◊ê÷∑◊î÷≤◊ë÷∏◊î', form: 'love', pattern: 'aqtala' },
                { word: '◊û÷∑◊ê÷≤◊î÷∏◊ë', form: 'beloved', pattern: 'maqtal' }
            ]},
            { root: '◊ô◊©◊ë', meaning: 'sit/dwell', examples: [
                { word: '◊ô÷∏◊©÷∑◊Å◊ë', form: 'he sat/dwelt', pattern: 'qatal' },
                { word: '◊ô◊ï÷π◊©÷µ◊Å◊ë', form: 'sitting/dweller', pattern: 'qotel' },
                { word: '◊û◊ï÷π◊©÷∏◊Å◊ë', form: 'seat/dwelling', pattern: 'moqual' },
                { word: '◊ô÷∞◊©÷¥◊Å◊ô◊ë÷∏◊î', form: 'sitting/academy', pattern: 'qetila' }
            ]},
            { root: '◊û◊ú◊ö', meaning: 'reign/rule', examples: [
                { word: '◊û÷∏◊ú÷∑◊ö÷∞', form: 'he reigned', pattern: 'qatal' },
                { word: '◊û÷∂◊ú÷∂◊ö÷∞', form: 'king', pattern: 'qetel' },
                { word: '◊û÷∑◊ú÷∞◊õ◊ï÷º◊™', form: 'kingdom', pattern: 'malqut' },
                { word: '◊û÷∑◊û÷∞◊ú÷∏◊õ÷∏◊î', form: 'kingdom', pattern: 'mamlaka' }
            ]},
            { root: '◊ë◊®◊ö', meaning: 'bless', examples: [
                { word: '◊ë÷µ÷º◊®÷∑◊ö÷∞', form: 'he blessed', pattern: 'qetal' },
                { word: '◊û÷∞◊ë÷∏◊®÷µ◊ö÷∞', form: 'blessing', pattern: 'meqatel' },
                { word: '◊ë÷∞÷º◊®÷∏◊õ÷∏◊î', form: 'blessing', pattern: 'qeraka' },
                { word: '◊ë÷∏÷º◊®◊ï÷º◊ö÷∞', form: 'blessed', pattern: 'qaruk' }
            ]},
            { root: '◊ñ◊õ◊®', meaning: 'remember', examples: [
                { word: '◊ñ÷∏◊õ÷∑◊®', form: 'he remembered', pattern: 'qatal' },
                { word: '◊ñ◊ï÷π◊õ÷µ◊®', form: 'remembering', pattern: 'qotel' },
                { word: '◊ñ÷¥◊õ÷∏÷º◊®◊ï÷π◊ü', form: 'memory', pattern: 'zikkaron' },
                { word: '◊û÷∑◊ñ÷∞◊õ÷∂÷º◊®÷∂◊™', form: 'souvenir', pattern: 'mazqeret' }
            ]},
            { root: '◊©◊ë◊™', meaning: 'rest/cease', examples: [
                { word: '◊©÷∏◊Å◊ë÷∑◊™', form: 'he rested', pattern: 'qatal' },
                { word: '◊©÷∑◊Å◊ë÷∏÷º◊™', form: 'Sabbath', pattern: 'qallat' },
                { word: '◊©÷∞◊Å◊ë÷¥◊ô◊™÷∏◊î', form: 'strike/rest', pattern: 'qetita' },
                { word: '◊û÷¥◊©÷∞◊Å◊ë÷∏÷º◊™', form: 'resting place', pattern: 'miqtal' }
            ]},
            { root: '◊†◊™◊ü', meaning: 'give', examples: [
                { word: '◊†÷∏◊™÷∑◊ü', form: 'he gave', pattern: 'qatal' },
                { word: '◊†◊ï÷π◊™÷µ◊ü', form: 'giving/giver', pattern: 'qotel' },
                { word: '◊û÷∑◊™÷∏÷º◊†÷∏◊î', form: 'gift', pattern: 'mattana' },
                { word: '◊†÷∞◊™÷¥◊ô◊†÷∏◊î', form: 'giving', pattern: 'qetina' }
            ]},
            { root: '◊©◊û◊¢', meaning: 'hear/listen', examples: [
                { word: '◊©÷∏◊Å◊û÷∑◊¢', form: 'he heard', pattern: 'qatal' },
                { word: '◊©◊Å◊ï÷π◊û÷µ◊¢÷∑', form: 'hearing/listener', pattern: 'qotel' },
                { word: '◊©÷µ◊Å◊û÷∑◊¢', form: 'report/fame', pattern: 'qetal' },
                { word: '◊û÷¥◊©÷∞◊Å◊û÷∏◊¢', form: 'meaning', pattern: 'miqtal' }
            ]},
            { root: '◊®◊ê◊î', meaning: 'see', examples: [
                { word: '◊®÷∏◊ê÷∏◊î', form: 'he saw', pattern: 'qatal' },
                { word: '◊®◊ï÷π◊ê÷∂◊î', form: 'seeing/seer', pattern: 'qotel' },
                { word: '◊û÷∑◊®÷∞◊ê÷∂◊î', form: 'appearance', pattern: 'marqeh' },
                { word: '◊®÷∞◊ê÷¥◊ô÷∏÷º◊î', form: 'vision', pattern: 'qetiyya' }
            ]},
            { root: '◊ì◊ë◊®', meaning: 'speak/word', examples: [
                { word: '◊ì÷¥÷º◊ë÷∂÷º◊®', form: 'he spoke', pattern: 'qitel' },
                { word: '◊ì÷∏÷º◊ë÷∏◊®', form: 'word/thing', pattern: 'qatal' },
                { word: '◊û÷∞◊ì÷∑◊ë÷µ÷º◊®', form: 'speaking', pattern: 'meqatel' },
                { word: '◊ì÷¥÷º◊ë÷º◊ï÷º◊®', form: 'speech', pattern: 'qillur' }
            ]},
            { root: '◊ß◊®◊ê', meaning: 'call/read', examples: [
                { word: '◊ß÷∏◊®÷∏◊ê', form: 'he called/read', pattern: 'qatal' },
                { word: '◊ß◊ï÷π◊®÷µ◊ê', form: 'calling/reader', pattern: 'qotel' },
                { word: '◊û÷¥◊ß÷∞◊®÷∏◊ê', form: 'Scripture', pattern: 'miqtal' },
                { word: '◊ß÷∞◊®÷¥◊ô◊ê÷∏◊î', form: 'reading', pattern: 'qetiya' }
            ]},
            { root: '◊ô◊¶◊ê', meaning: 'go out/exit', examples: [
                { word: '◊ô÷∏◊¶÷∏◊ê', form: 'he went out', pattern: 'qatal' },
                { word: '◊ô◊ï÷π◊¶÷µ◊ê', form: 'going out', pattern: 'qotel' },
                { word: '◊û◊ï÷π◊¶÷∏◊ê', form: 'exit/origin', pattern: 'moqua' },
                { word: '◊ô÷∞◊¶÷¥◊ô◊ê÷∏◊î', form: 'exodus', pattern: 'qetiya' }
            ]},
            { root: '◊ë◊ï◊ê', meaning: 'come/enter', examples: [
                { word: '◊ë÷∏÷º◊ê', form: 'he came', pattern: 'qal' },
                { word: '◊ë÷∏÷º◊ê', form: 'coming', pattern: 'qotel' },
                { word: '◊û÷∏◊ë◊ï÷π◊ê', form: 'entrance', pattern: 'maqol' },
                { word: '◊ë÷¥÷º◊ô◊ê÷∏◊î', form: 'coming', pattern: 'qiya' }
            ]}
        ];

        let selected = [], cardIndex = 0, flipped = false, quizIndex = 0, score = 0;
        let wordCardIndex = 0, wordFlipped = false, matches = {}, dragMatches = {};
        let currentDragLetters = [], selectedHebrewWord = null;
        let rootCardIndex = 0, rootFlipped = false, patternQuizIndex = 0, patternScore = 0;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initAlphabet();
            initTabs();
            initFlashcards();
            initQuiz();
            initDragDrop();
            initSiddur();
            initRoots();
        });

        function initTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
                    btn.classList.add('active');
                    document.getElementById(btn.dataset.tab).classList.remove('hidden');
                });
            });
        }

        function initAlphabet() {
            const grid = document.getElementById('hebrewGrid');
            letters.forEach((letter, i) => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                const variantText = letter.variant ? `<div style="font-size: 0.8em; color: #95a5a6; margin-top: 5px;">${letter.variant}</div>` : '';
                card.innerHTML = `
                    <div class="hebrew-char">${letter.char}</div>
                    <div style="font-size: 1.2em; font-weight: bold;">${letter.name}</div>
                    <div style="color: #7f8c8d;">Sound: ${letter.sound}</div>
                    <div style="color: #95a5a6;">Value: ${letter.number}</div>
                    ${variantText}
                `;
                card.addEventListener('click', () => toggleSelect(i, card));
                grid.appendChild(card);
            });

            // Initialize vowels
            const vowelsGrid = document.getElementById('vowelsGrid');
            vowels.forEach(vowel => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.style.cursor = 'default';
                card.style.backgroundColor = '#f0f8ff';
                card.innerHTML = `
                    <div class="hebrew-char" style="font-size: 3em;">◊ë${vowel.char}</div>
                    <div style="font-size: 1.1em; font-weight: bold;">${vowel.name}</div>
                    <div style="color: #7f8c8d;">Sound: ${vowel.sound}</div>
                    <div style="color: #95a5a6; font-size: 0.9em;">${vowel.type}</div>
                    ${vowel.example ? `<div style="color: #3498db; font-size: 0.8em; margin-top: 5px;">Ex: ${vowel.example}</div>` : ''}
                `;
                vowelsGrid.appendChild(card);
            });

            // Initialize final letters
            const finalLettersGrid = document.getElementById('finalLettersGrid');
            finalLetters.forEach(letter => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.style.cursor = 'default';
                card.style.backgroundColor = '#fff8f0';
                card.innerHTML = `
                    <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 10px;">
                        <div style="text-align: center;">
                            <div class="hebrew-char" style="font-size: 2.5em;">${letter.regular}</div>
                            <div style="font-size: 0.8em; color: #95a5a6;">Regular</div>
                        </div>
                        <div style="color: #e74c3c; font-size: 2em; align-self: center;">‚Üí</div>
                        <div style="text-align: center;">
                            <div class="hebrew-char" style="font-size: 2.5em;">${letter.final}</div>
                            <div style="font-size: 0.8em; color: #95a5a6;">Final</div>
                        </div>
                    </div>
                    <div style="font-size: 1.1em; font-weight: bold;">${letter.name}</div>
                    <div style="color: #7f8c8d;">Sound: ${letter.sound}</div>
                    <div style="color: #95a5a6;">Value: ${letter.number}</div>
                    <div style="color: #3498db; font-size: 0.8em; margin-top: 8px; line-height: 1.3;">
                        <div>Regular: ${letter.examples.regular}</div>
                        <div>Final: ${letter.examples.final}</div>
                    </div>
                `;
                finalLettersGrid.appendChild(card);
            });

            document.getElementById('selectAll').onclick = () => {
                selected = [...Array(letters.length).keys()];
                document.querySelectorAll('#hebrewGrid .letter-card').forEach(c => c.classList.add('selected'));
                updateProgress();
            };

            document.getElementById('clearAll').onclick = () => {
                selected = [];
                document.querySelectorAll('#hebrewGrid .letter-card').forEach(c => c.classList.remove('selected'));
                updateProgress();
            };

            document.getElementById('startLearning').onclick = () => {
                if (selected.length === 0) {
                    alert('Select letters first!');
                    return;
                }
                document.querySelector('[data-tab="flashcards"]').click();
                prepareFlashcards();
            };

            document.getElementById('showVowels').onclick = () => {
                const vowelsSection = document.getElementById('vowelsSection');
                const button = document.getElementById('showVowels');
                if (vowelsSection.classList.contains('hidden')) {
                    vowelsSection.classList.remove('hidden');
                    button.textContent = 'Hide Vowels';
                    button.classList.remove('btn-primary');
                    button.classList.add('btn-warning');
                } else {
                    vowelsSection.classList.add('hidden');
                    button.textContent = 'Show Vowels';
                    button.classList.remove('btn-warning');
                    button.classList.add('btn-primary');
                }
            };

            document.getElementById('showFinalLetters').onclick = () => {
                const finalSection = document.getElementById('finalLettersSection');
                const button = document.getElementById('showFinalLetters');
                if (finalSection.classList.contains('hidden')) {
                    finalSection.classList.remove('hidden');
                    button.textContent = 'Hide Final Letters';
                    button.classList.remove('btn-primary');
                    button.classList.add('btn-warning');
                } else {
                    finalSection.classList.add('hidden');
                    button.textContent = 'Final Letters';
                    button.classList.remove('btn-warning');
                    button.classList.add('btn-primary');
                }
            };
        }

        function toggleSelect(i, card) {
            const idx = selected.indexOf(i);
            if (idx === -1) {
                selected.push(i);
                card.classList.add('selected');
            } else {
                selected.splice(idx, 1);
                card.classList.remove('selected');
            }
            updateProgress();
        }

        function updateProgress() {
            const pct = Math.round((selected.length / letters.length) * 100);
            const bar = document.getElementById('alphabetProgress');
            bar.style.width = pct + '%';
            bar.textContent = `${pct}% Selected (${selected.length}/${letters.length})`;
        }

        function initFlashcards() {
            document.getElementById('prevCard').onclick = () => {
                if (selected.length === 0) return;
                cardIndex = cardIndex > 0 ? cardIndex - 1 : selected.length - 1;
                flipped = false;
                showCard();
            };
            document.getElementById('nextCard').onclick = () => {
                if (selected.length === 0) return;
                cardIndex = cardIndex < selected.length - 1 ? cardIndex + 1 : 0;
                flipped = false;
                showCard();
            };
            document.getElementById('flipCard').onclick = () => {
                flipped = !flipped;
                showCard();
            };
        }

        function prepareFlashcards() {
            if (selected.length === 0) selected = [...Array(letters.length).keys()];
            cardIndex = 0;
            flipped = false;
            showCard();
        }

        function showCard() {
            if (selected.length === 0) return;
            const letter = letters[selected[cardIndex]];
            document.getElementById('cardChar').textContent = letter.char;
            document.getElementById('cardInfo').textContent = flipped ? 
                `${letter.name} ‚Ä¢ Sound: ${letter.sound} ‚Ä¢ Value: ${letter.number}${letter.variant ? ' ‚Ä¢ ' + letter.variant : ''}` : 
                'Click "Flip Card" to see details';
            document.getElementById('cardCounter').textContent = `Card ${cardIndex + 1} of ${selected.length}`;
        }

        function initQuiz() {
            document.getElementById('nextQuestion').onclick = nextQuestion;
            startQuiz();
        }

        function startQuiz() {
            quizIndex = 0;
            score = 0;
            updateQuizProgress();
            nextQuestion();
        }

        function nextQuestion() {
            if (selected.length === 0) selected = [...Array(letters.length).keys()];
            if (quizIndex >= 10) {
                alert(`Quiz complete! Score: ${score}/10`);
                startQuiz();
                return;
            }

            const correctIdx = selected[Math.floor(Math.random() * selected.length)];
            const correct = letters[correctIdx];
            document.getElementById('quizChar').textContent = correct.char;

            const options = [correct];
            while (options.length < 4) {
                const random = letters[Math.floor(Math.random() * letters.length)];
                if (!options.find(o => o.name === random.name)) options.push(random);
            }
            
            shuffle(options);
            const container = document.getElementById('quizOptions');
            container.innerHTML = '';
            
            options.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option';
                btn.textContent = opt.name;
                btn.onclick = () => {
                    // Disable all options
                    container.querySelectorAll('.quiz-option').forEach(o => o.onclick = null);
                    
                    if (opt.name === correct.name) {
                        btn.classList.add('correct');
                        score++;
                    } else {
                        btn.classList.add('incorrect');
                        // Show correct answer
                        container.querySelectorAll('.quiz-option').forEach(o => {
                            if (o.textContent === correct.name) {
                                o.classList.add('correct');
                            }
                        });
                    }
                    quizIndex++;
                    updateQuizProgress();
                    setTimeout(nextQuestion, 1500);
                };
                container.appendChild(btn);
            });
        }

        function updateQuizProgress() {
            const bar = document.getElementById('quizProgress');
            bar.style.width = (quizIndex / 10) * 100 + '%';
            bar.textContent = `${quizIndex}/10 (Score: ${score})`;
        }

        function initDragDrop() {
            document.getElementById('checkDragMatches').onclick = checkDragMatches;
            document.getElementById('resetDragDrop').onclick = resetDragDrop;
            resetDragDrop(); // Initialize first round
        }

        function resetDragDrop() {
            // Select 5 random letters for the game
            const gameLetters = shuffle([...letters]).slice(0, 5);
            currentDragLetters = gameLetters;
            dragMatches = {};

            // Create draggable letter names
            const dragContainer = document.getElementById('dragLetters');
            dragContainer.innerHTML = '';
            const shuffledNames = shuffle([...gameLetters.map(l => l.name)]);
            
            shuffledNames.forEach(name => {
                const dragItem = document.createElement('div');
                dragItem.className = 'drag-item';
                dragItem.textContent = name;
                dragItem.draggable = true;
                dragItem.dataset.name = name;
                
                dragItem.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', name);
                    dragItem.classList.add('dragging');
                });
                
                dragItem.addEventListener('dragend', () => {
                    dragItem.classList.remove('dragging');
                });
                
                dragContainer.appendChild(dragItem);
            });

            // Create drop zones for Hebrew characters
            const dropContainer = document.getElementById('dropZones');
            dropContainer.innerHTML = '';
            
            gameLetters.forEach(letter => {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone';
                dropZone.dataset.char = letter.char;
                dropZone.innerHTML = `
                    <div class="hebrew-char">${letter.char}</div>
                    <div style="font-size: 1.1em; color: #7f8c8d;">Drop name here</div>
                `;
                
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('drag-over');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('drag-over');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                    
                    const draggedName = e.dataTransfer.getData('text/plain');
                    const draggedElement = document.querySelector(`[data-name="${draggedName}"]`);
                    
                    if (draggedElement) {
                        // Remove any existing dropped item in this zone
                        const existing = dropZone.querySelector('.drag-item');
                        if (existing) {
                            document.getElementById('dragLetters').appendChild(existing);
                        }
                        
                        // Add the new item
                        dropZone.appendChild(draggedElement);
                        dropZone.classList.add('filled');
                        dragMatches[letter.char] = draggedName;
                        
                        // Update the drop zone display
                        dropZone.innerHTML = `
                            <div class="hebrew-char">${letter.char}</div>
                            <div style="font-size: 1.1em; font-weight: bold; color: #2c3e50;">${draggedName}</div>
                        `;
                        dropZone.appendChild(draggedElement);
                        draggedElement.style.display = 'none'; // Hide the draggable item
                    }
                });
                
                dropContainer.appendChild(dropZone);
            });
        }

        function checkDragMatches() {
            let correct = 0;
            let total = currentDragLetters.length;
            
            currentDragLetters.forEach(letter => {
                const dropZone = document.querySelector(`[data-char="${letter.char}"]`);
                const droppedName = dragMatches[letter.char];
                
                if (droppedName === letter.name) {
                    dropZone.style.borderColor = '#2ecc71';
                    dropZone.style.backgroundColor = 'rgba(46, 204, 113, 0.2)';
                    correct++;
                } else {
                    dropZone.style.borderColor = '#e74c3c';
                    dropZone.style.backgroundColor = 'rgba(231, 76, 60, 0.2)';
                }
            });
            
            setTimeout(() => {
                alert(`You got ${correct} out of ${total} correct!`);
                setTimeout(resetDragDrop, 1000);
            }, 1000);
        }

        function initSiddur() {
            const grid = document.getElementById('siddurWordGrid');
            words.forEach(word => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.style.cursor = 'default';
                card.innerHTML = `
                    <div class="hebrew-char" style="font-size: 2.5em;">${word.hebrew}</div>
                    <div style="font-size: 1.1em; margin-top: 10px;">${word.meaning}</div>
                `;
                grid.appendChild(card);
            });

            document.getElementById('wordFlashcards').onclick = () => {
                document.getElementById('siddurWordGrid').classList.add('hidden');
                document.getElementById('wordGames').classList.remove('hidden');
                document.getElementById('wordFlashcardGame').classList.remove('hidden');
                document.getElementById('wordMatchingGame').classList.add('hidden');
                wordCardIndex = 0;
                wordFlipped = false;
                showWordCard();
            };

            document.getElementById('wordMatching').onclick = startMatching;

            document.getElementById('prevWordCard').onclick = () => {
                wordCardIndex = wordCardIndex > 0 ? wordCardIndex - 1 : words.length - 1;
                wordFlipped = false;
                showWordCard();
            };

            document.getElementById('nextWordCard').onclick = () => {
                wordCardIndex = wordCardIndex < words.length - 1 ? wordCardIndex + 1 : 0;
                wordFlipped = false;
                showWordCard();
            };

            document.getElementById('flipWordCard').onclick = () => {
                wordFlipped = !wordFlipped;
                showWordCard();
            };

            document.getElementById('checkMatches').onclick = checkMatches;
            document.getElementById('newRound').onclick = startMatching;
        }

        function showWordCard() {
            const word = words[wordCardIndex];
            document.getElementById('wordCardHebrew').textContent = word.hebrew;
            document.getElementById('wordCardInfo').textContent = wordFlipped ? word.meaning : 'Click to reveal meaning';
            
            // Update counter if element exists
            const counter = document.getElementById('wordCardCounter');
            if (counter) {
                counter.textContent = `Word ${wordCardIndex + 1} of ${words.length}`;
            }
        }

        function startMatching() {
            document.getElementById('siddurWordGrid').classList.add('hidden');
            document.getElementById('wordGames').classList.remove('hidden');
            document.getElementById('wordFlashcardGame').classList.add('hidden');
            document.getElementById('wordMatchingGame').classList.remove('hidden');

            const gameWords = shuffle([...words]).slice(0, 6);
            const hebrewContainer = document.getElementById('hebrewWords');
            const englishContainer = document.getElementById('englishMeanings');
            
            hebrewContainer.innerHTML = '<h4 style="text-align: center; margin-bottom: 15px;">Hebrew Words</h4>';
            englishContainer.innerHTML = '<h4 style="text-align: center; margin-bottom: 15px;">English Meanings</h4>';
            matches = {};
            selectedHebrewWord = null;

            gameWords.forEach((word, i) => {
                const hebrewDiv = document.createElement('div');
                hebrewDiv.className = 'quiz-option';
                hebrewDiv.innerHTML = `<div class="hebrew-char" style="font-size: 2em;">${word.hebrew}</div>`;
                hebrewDiv.dataset.hebrew = word.hebrew;
                hebrewDiv.onclick = () => selectHebrewWord(hebrewDiv, word.hebrew);
                hebrewContainer.appendChild(hebrewDiv);
            });

            const shuffledMeanings = shuffle([...gameWords]);
            shuffledMeanings.forEach(word => {
                const englishDiv = document.createElement('div');
                englishDiv.className = 'quiz-option';
                englishDiv.textContent = word.meaning;
                englishDiv.dataset.meaning = word.meaning;
                englishDiv.dataset.hebrew = word.hebrew;
                englishDiv.onclick = () => selectEnglishMeaning(englishDiv, word.meaning, word.hebrew);
                englishContainer.appendChild(englishDiv);
            });
        }

        function selectHebrewWord(el, hebrew) {
            document.querySelectorAll('#hebrewWords .quiz-option').forEach(e => e.classList.remove('selected'));
            el.classList.add('selected');
            selectedHebrewWord = hebrew;
        }

        function selectEnglishMeaning(el, meaning, correctHebrew) {
            if (!selectedHebrewWord) {
                alert('Please select a Hebrew word first!');
                return;
            }
            
            matches[selectedHebrewWord] = meaning;
            
            // Visual feedback
            if (selectedHebrewWord === correctHebrew) {
                el.classList.add('correct');
                document.querySelector(`[data-hebrew="${selectedHebrewWord}"]`).classList.add('correct');
            } else {
                el.classList.add('incorrect');
                document.querySelector(`[data-hebrew="${selectedHebrewWord}"]`).classList.add('incorrect');
            }
            
            // Reset selection
            selectedHebrewWord = null;
            document.querySelectorAll('#hebrewWords .quiz-option').forEach(e => e.classList.remove('selected'));
        }

        function checkMatches() {
            let correct = 0;
            let total = Object.keys(matches).length;
            
            if (total === 0) {
                alert('Please make some matches first!');
                return;
            }
            
            Object.keys(matches).forEach(hebrew => {
                const correctWord = words.find(w => w.hebrew === hebrew);
                if (correctWord && matches[hebrew] === correctWord.meaning) {
                    correct++;
                }
            });
            
            alert(`You got ${correct} out of ${total} matches correct!`);
            setTimeout(startMatching, 2000);
        }

        function backToSiddur() {
            document.getElementById('siddurWordGrid').classList.remove('hidden');
            document.getElementById('wordGames').classList.add('hidden');
            document.getElementById('wordFlashcardGame').classList.add('hidden');
            document.getElementById('wordMatchingGame').classList.add('hidden');
        }

        function shuffle(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function initRoots() {
            const grid = document.getElementById('rootsGrid');
            hebrewRoots.forEach(root => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.style.cursor = 'default';
                card.innerHTML = `
                    <div class="hebrew-char" style="font-size: 3em;">${root.root}</div>
                    <div style="font-size: 1.2em; font-weight: bold; margin: 10px 0;">${root.meaning}</div>
                    <div style="color: #7f8c8d; font-size: 0.9em;">${root.examples.length} example words</div>
                `;
                grid.appendChild(card);
            });

            document.getElementById('rootFlashcards').onclick = () => {
                document.getElementById('rootsGrid').classList.add('hidden');
                document.getElementById('rootGames').classList.remove('hidden');
                document.getElementById('rootFlashcardGame').classList.remove('hidden');
                document.getElementById('patternQuizGame').classList.add('hidden');
                rootCardIndex = 0;
                rootFlipped = false;
                showRootCard();
            };

            document.getElementById('patternQuiz').onclick = () => {
                document.getElementById('rootsGrid').classList.add('hidden');
                document.getElementById('rootGames').classList.remove('hidden');
                document.getElementById('rootFlashcardGame').classList.add('hidden');
                document.getElementById('patternQuizGame').classList.remove('hidden');
                startPatternQuiz();
            };

            document.getElementById('showAllRoots').onclick = () => {
                document.getElementById('rootsGrid').classList.toggle('hidden');
            };

            document.getElementById('prevRootCard').onclick = () => {
                rootCardIndex = rootCardIndex > 0 ? rootCardIndex - 1 : hebrewRoots.length - 1;
                rootFlipped = false;
                showRootCard();
            };

            document.getElementById('nextRootCard').onclick = () => {
                rootCardIndex = rootCardIndex < hebrewRoots.length - 1 ? rootCardIndex + 1 : 0;
                rootFlipped = false;
                showRootCard();
            };

            document.getElementById('flipRootCard').onclick = () => {
                rootFlipped = !rootFlipped;
                showRootCard();
            };

            document.getElementById('nextPatternQuestion').onclick = nextPatternQuestion;
        }

        function showRootCard() {
            const root = hebrewRoots[rootCardIndex];
            document.getElementById('rootCardRoot').textContent = root.root;
            document.getElementById('rootCardInfo').textContent = rootFlipped ? 
                `Root meaning: ${root.meaning}` : 
                'Click to reveal meaning and examples';
            
            const examplesDiv = document.getElementById('rootExamples');
            const examplesList = document.getElementById('examplesList');
            
            if (rootFlipped) {
                examplesDiv.classList.remove('hidden');
                examplesList.innerHTML = root.examples.map(ex => 
                    `<div style="margin: 8px 0; padding: 10px; background: white; border-radius: 8px;">
                        <span class="hebrew-char" style="font-size: 1.5em;">${ex.word}</span> - 
                        <strong>${ex.form}</strong> 
                        <span style="color: #7f8c8d;">(${ex.pattern})</span>
                    </div>`
                ).join('');
            } else {
                examplesDiv.classList.add('hidden');
            }
            
            document.getElementById('rootCardCounter').textContent = `Root ${rootCardIndex + 1} of ${hebrewRoots.length}`;
        }

        function startPatternQuiz() {
            patternQuizIndex = 0;
            patternScore = 0;
            updatePatternProgress();
            nextPatternQuestion();
        }

        function nextPatternQuestion() {
            if (patternQuizIndex >= 10) {
                alert(`Pattern Quiz complete! Score: ${patternScore}/10`);
                startPatternQuiz();
                return;
            }

            const correctRoot = hebrewRoots[Math.floor(Math.random() * hebrewRoots.length)];
            const correctExample = correctRoot.examples[Math.floor(Math.random() * correctRoot.examples.length)];
            
            document.getElementById('patternQuizWord').textContent = correctExample.word;

            const options = [correctRoot];
            while (options.length < 4) {
                const random = hebrewRoots[Math.floor(Math.random() * hebrewRoots.length)];
                if (!options.find(o => o.root === random.root)) options.push(random);
            }
            
            shuffle(options);
            const container = document.getElementById('patternOptions');
            container.innerHTML = '';
            
            options.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'quiz-option';
                btn.innerHTML = `<div class="hebrew-char" style="font-size: 1.5em;">${opt.root}</div><div>${opt.meaning}</div>`;
                btn.onclick = () => {
                    // Disable all options
                    container.querySelectorAll('.quiz-option').forEach(o => o.onclick = null);
                    
                    if (opt.root === correctRoot.root) {
                        btn.classList.add('correct');
                        patternScore++;
                    } else {
                        btn.classList.add('incorrect');
                        // Show correct answer
                        container.querySelectorAll('.quiz-option').forEach(o => {
                            if (o.innerHTML.includes(correctRoot.root)) {
                                o.classList.add('correct');
                            }
                        });
                    }
                    patternQuizIndex++;
                    updatePatternProgress();
                    setTimeout(nextPatternQuestion, 2000);
                };
                container.appendChild(btn);
            });
        }

        function updatePatternProgress() {
            const bar = document.getElementById('patternProgress');
            bar.style.width = (patternQuizIndex / 10) * 100 + '%';
            bar.textContent = `${patternQuizIndex}/10 (Score: ${patternScore})`;
        }

        function backToRoots() {
            document.getElementById('rootsGrid').classList.remove('hidden');
            document.getElementById('rootGames').classList.add('hidden');
            document.getElementById('rootFlashcardGame').classList.add('hidden');
            document.getElementById('patternQuizGame').classList.add('hidden');
        }
    </script>
</body>
</html>
